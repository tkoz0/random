'''
Reads from stdin. Expects the output of the sscan.c program. Writes subsets to
stdout in a easy to parse format.
'''

numbers = [
    5719825393567961346558155629,
    5487945882843158696672157984,
    4767766531754254874224257763,
    1855924359757732125866239784,
    4289776424589197647513647977,
    7967131961768854889594217186,
    2572967277666133789225764888,
    1294587141921952639693619381,
    4764413635323911361699183586,
    1474343641823476922667154474,
    2578649763684913163429325833,
    5161596985226568681977938754,
    2242632698981685551523361879,
    7474189614567412367516833398,
    6211855673345949471748161445,
    4942716233498772219251848674,
    5516264359672753836539861178,
    5854762719618549417768925747,
    5313691171963952518124735471,
    6737691754241231469753717635,
    4292388614454146728246198812,
    4468463715866746258976552344,
    2638621731822362373162811879,
    1258922263729296589785418839,
    4482279727264797827654899397,
    8749855322285371162986411895,
    1116599457961971796683936952,
    3879213273596322735993329751,
    9212359131574159657168196759,
    3351223183818712673691977472,
    8855835322812512868896449976,
    4332859486871255922555418653,
    2428751582371964453381751663,
    6738481866868951787884276161,
    8794353172213177612939776215,
    2989694245827479769152313629,
    6117454427987751131467589412,
    2761854485919763568442339436,
    6884214746997985976433695787,
    8671829218381757417536862814,
    9431156837244768326468938597,
    4788448664674885883585184169,
    3624757247737414772711372622,
    9361819764286243182121963365,
    9893315516156422581529354454,
    5913625989853975289562158982,
    8313891548569672814692858479,
    2265865138518379114874613969,
    3477184288963424358211752214,
    6321349612522496241515883378,
    1796439694824213266958886393,
    6366252531759955676944496585,
    8545458545636898974365938274,
    3362291186211522318566852576,
    8464473866375474967347772855,
    2892857564355262219965984217,
    4296693937661266715382241936,
    8634764617265724716389775433,
    8415234243182787534123894858,
    2267353254454872616182242154,
    4689911847578741473186337883,
    4428766787964834371794565542,
    7146295186764167268433238125,
    2273823813572968577469388278,
    6686132721336864457635223349,
    3161518296576488158997146221,
    1917611425739928285147758625,
    3516431537343387135357237754,
    7549684656732941456945632221,
    2397876675349971994958579984,
    4675844257857378792991889317,
    2832515241382937498614676246,
    8755442772953263299368382378,
    9833662825734624455736638328,
    5298671253425423454611152788,
    9857512879181186421823417538,
    1471226144331341144787865593,
    3545439374321661651385735599,
    6735367616915626462272211264,
    2141665754145475249654938214,
    8481747257332513758286947416,
    9961217236253576952797397966,
    9941237996445827218665222824,
    6242177493463484861915865966,
    4344843511782912875843632652,
    7568842562748136518615117797,
    2776621559882146125114473423,
    6174299197447843873145457215,
    5387584131525787615617563371,
    5317693353372572284588242963,
    6612142515552593663955966562,
    1314928587713292493616625427,
    2446827667287451685939173534,
    9786693878731984534924558138,
    2926718838742634774778713813,
    3791426274497596641969142899,
    2831727715176299968774951996,
    3281287353463725292271916883,
    9954744594922386766735519674,
    3414339143545324298853248718
]

import struct, sys

def subset_sum(subset): # subset should be a length 16 byte string
    first64 = struct.unpack('<Q',subset[:8])[0]
    second,third = struct.unpack('<LL',subset[8:])
    last36 = (second & 0x1FF) | ((second >> 23) << 9) \
            | ((third & 0x1FF) << 18) | ((third >> 23) << 27)
    bitflags = first64 | (last36 << 64)
    sum_result = 0
    for i in range(100):
        sum_result += (bitflags & 1) * numbers[i]
        bitflags >>= 1
    return sum_result

def subset_nums(subset):
    first64 = struct.unpack('<Q',subset[:8])[0]
    second,third = struct.unpack('<LL',subset[8:])
    last36 = (second & 0x1FF) | ((second >> 23) << 9) \
            | ((third & 0x1FF) << 18) | ((third >> 23) << 27)
    bitflags = first64 | (last36 << 64)
    nums_result = []
    for i in range(100):
        if (bitflags & 1) == 1:
            nums_result.append(numbers[i])
        bitflags >>= 1
    return nums_result

# test verify 1
if len(sys.argv) > 1 and sys.argv[1] == 'test_verify_1':
    ss1 = struct.pack('<QQ',10425885956172978299,13909836399656329984)
    ss2 = struct.pack('<QQ',5312149853831446800,13055989285571707944)
    print('subset sums equal?',subset_sum(ss1)==subset_sum(ss2))
    print('subset sums =',subset_sum(ss1))
    nums1 = set(subset_nums(ss1))
    nums2 = set(subset_nums(ss2))
    print('SUBSETS FOUND')
    print('ss1 =',nums1)
    print('ss2 =',nums2)
    print('subsets equal?',nums1 == nums2)
    shared = nums1 & nums2
    print('INTERSECTION')
    print('ss1&ss2 =',shared)
    print('DISJOINT SUBSETS')
    print('ss1d =',nums1-shared)
    print('ss2d =',nums2-shared)

    print('ASSERTING REQUIRED PROPERTIES')
    assert subset_sum(ss1) == subset_sum(ss2)
    assert nums1 <= set(numbers)
    assert nums2 <= set(numbers)
    assert nums1 != nums2

numbersset = set(numbers)

number2index = dict() # order of numbers for sorting
for i,num in enumerate(numbers):
    number2index[num] = i

# stdin reading
while True:
    try: line = input()
    except: break
    assert line.startswith('DUPLICATE')
    i1,i2 = map(int,line[9:].strip()[1:-1].split(','))
    # parse set data
    set1line = input()
    set2line = input()
    a,b = map(int,set1line[set1line.find('=')+3:-1].split(','))
    set1 = set(subset_nums(struct.pack('<QQ',a,b)))
    a,b = map(int,set2line[set2line.find('=')+3:-1].split(','))
    set2 = set(subset_nums(struct.pack('<QQ',a,b)))
    # skip lines that output the sum
    input()
    input()
    # verify
    if set1 == set2:
        sys.stderr.write('false positive\n')
        continue
    assert set1 != set2
    assert sum(set1) == sum(set2)
    assert set1 <= numbersset
    assert set2 <= numbersset
    sys.stderr.write('verified\n')
    print(' '.join(sorted(map(str,set1),key=lambda x:number2index[int(x)])))
    print(' '.join(sorted(map(str,set2),key=lambda x:number2index[int(x)])))
